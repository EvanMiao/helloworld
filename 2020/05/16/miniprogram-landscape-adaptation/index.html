<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微信小程序横屏适配问题 | Evan Miao</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="使用 vmin 可以将屏幕宽度固定为竖屏时的宽度（锁定屏幕的短边），这样无论横屏竖屏，屏幕宽度总是等于 100vmin ，代入 rpx 的计算规则，将 rpx 换算成 vmin 即可完美适配。">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.b33b3459.css" as="style"><link rel="preload" href="/assets/js/app.f964d282.js" as="script"><link rel="preload" href="/assets/js/6.921146d0.js" as="script"><link rel="preload" href="/assets/js/3.6e0db218.js" as="script"><link rel="preload" href="/assets/js/27.77ae7cd4.js" as="script"><link rel="prefetch" href="/assets/js/10.8df6afd1.js"><link rel="prefetch" href="/assets/js/11.ea21541e.js"><link rel="prefetch" href="/assets/js/12.fece939c.js"><link rel="prefetch" href="/assets/js/13.198c1409.js"><link rel="prefetch" href="/assets/js/14.1b487f01.js"><link rel="prefetch" href="/assets/js/15.578eb31a.js"><link rel="prefetch" href="/assets/js/16.bf32a8f3.js"><link rel="prefetch" href="/assets/js/17.c2513ebe.js"><link rel="prefetch" href="/assets/js/18.aba1ccd9.js"><link rel="prefetch" href="/assets/js/19.af6f2bb9.js"><link rel="prefetch" href="/assets/js/20.5974bf52.js"><link rel="prefetch" href="/assets/js/21.9b60c318.js"><link rel="prefetch" href="/assets/js/22.5c06046d.js"><link rel="prefetch" href="/assets/js/23.b421d998.js"><link rel="prefetch" href="/assets/js/24.d69f6f45.js"><link rel="prefetch" href="/assets/js/25.cacdd98f.js"><link rel="prefetch" href="/assets/js/26.9e5df746.js"><link rel="prefetch" href="/assets/js/28.0a19dd80.js"><link rel="prefetch" href="/assets/js/29.c9d09a11.js"><link rel="prefetch" href="/assets/js/30.d95afe7d.js"><link rel="prefetch" href="/assets/js/31.251b2b42.js"><link rel="prefetch" href="/assets/js/32.057babe5.js"><link rel="prefetch" href="/assets/js/4.9b493ed8.js"><link rel="prefetch" href="/assets/js/5.7037f85f.js"><link rel="prefetch" href="/assets/js/7.d7e3ede3.js"><link rel="prefetch" href="/assets/js/8.d193aae7.js"><link rel="prefetch" href="/assets/js/9.16f91c41.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.2e9678df.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b33b3459.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">Evan Miao </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">Home</a></li><li class="nav-item"><a href="/tag/" class="nav-link">Tag</a></li><li class="nav-item"><a href="/about/" class="nav-link">About</a></li><li class="nav-item"><a href="https://github.com/evanmiao" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">Evan Miao </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">Home</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">Tag</a></li><li class="mobile-nav-item"><a href="/about/" class="nav-link">About</a></li><li class="mobile-nav-item"><a href="https://github.com/evanmiao" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        微信小程序横屏适配问题
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2020-05-16T00:00:00.000Z">
      Sat May 16 2020
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/小程序" data-v-42ccfcd5><span data-v-42ccfcd5>小程序</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/踩坑" data-v-42ccfcd5><span data-v-42ccfcd5>踩坑</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h2 id="开启横屏"><a href="#开启横屏" class="header-anchor">#</a> 开启横屏</h2> <blockquote><p>在 <code>app.json</code> 的 <code>window</code> 段中设置 <code>&quot;pageOrientation&quot;: &quot;auto&quot;</code> ，或在页面 json 文件中配置 <code>&quot;pageOrientation&quot;: &quot;auto&quot;</code> 。</p></blockquote> <p><code>pageOrientation</code> 配置项</p> <ul><li><code>auto</code> ：自动</li> <li><code>portrait</code> ：竖屏（默认）</li> <li><code>landscape</code> ：横屏</li></ul> <h2 id="适配问题"><a href="#适配问题" class="header-anchor">#</a> 适配问题</h2> <p>微信小程序设置横屏之后原本的 <code>rpx</code> 单位就不再适用。</p> <blockquote><p>rpx（responsive pixel）: 可以根据屏幕宽度进行自适应。规定屏幕宽为750rpx。如在 iPhone6 上，屏幕宽度为375px，共有750个物理像素，则750rpx = 375px = 750物理像素，1rpx = 0.5px = 1物理像素。</p></blockquote> <p>如果在开发横屏页面时直接使用 <code>rpx</code> 作为单位，元素会被拉伸放大，因为竖屏切换为横屏后，<code>rpx</code> 的计算会以竖屏时的高度（也就是手机屏幕的高）作为屏幕宽度，<strong>1rpx = 1 / 750 * 屏幕宽度</strong>，屏幕宽度变大，1rpx 也会随之变大。</p> <p>使用 <code>px</code> 作为单位可以解决元素放大的问题，但失去了自适应效果。</p> <h2 id="使用-vmin-进行布局"><a href="#使用-vmin-进行布局" class="header-anchor">#</a> 使用 <code>vmin</code> 进行布局</h2> <blockquote><p>vw : 1vw 等于视口宽度的 1%</p> <p>vh : 1vh 等于视口高度的 1%</p> <p>vmin : 当前 vw 和 vh 中较小的值</p> <p>vmax : 当前 vw 和 vh 中较大的值</p></blockquote> <p>使用 <code>vmin</code> 可以将屏幕宽度固定为竖屏时的宽度（锁定屏幕的短边），这样无论横屏竖屏，屏幕宽度总是等于 <code>100vmin</code> ，代入 <code>rpx</code> 的计算规则，将 <code>rpx</code> 换算成 <code>vmin</code> 即可完美适配。</p> <p>1rpx =  1 / 750 * 100vmin  ⇔  1rpx = 1vmin / 7.5</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* 设置宽度为 5rpx */</span>
<span class="token selector">.box</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>5vmin / 7.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="使用-css-预处理器"><a href="#使用-css-预处理器" class="header-anchor">#</a> 使用 CSS 预处理器</h2> <p>这里以 <code>scss</code> 为例，有函数和混合两种方式：</p> <div class="language-scss line-numbers-mode"><pre class="language-scss"><code><span class="token comment">// function</span>
<span class="token keyword">@function</span> <span class="token function">rpx2vmin</span><span class="token punctuation">(</span><span class="token variable">$rpx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">@return</span> #<span class="token punctuation">{</span><span class="token variable">$rpx</span> <span class="token operator">/</span> 7.5<span class="token punctuation">}</span>vmin<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.box </span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">rpx2vmin</span><span class="token punctuation">(</span>5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-scss line-numbers-mode"><pre class="language-scss"><code><span class="token comment">// mixin</span>
<span class="token keyword">@mixin</span> <span class="token function">rpx2vmin</span><span class="token punctuation">(</span><span class="token variable">$property</span><span class="token punctuation">,</span> <span class="token variable">$rpxValues</span>...<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token property"><span class="token variable">$max</span></span><span class="token punctuation">:</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token variable">$rpxValues</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 返回 $rpxValues 列表的长度值</span>
  <span class="token property"><span class="token variable">$rpxValue</span></span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token property"><span class="token variable">$vminValues</span></span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>

  <span class="token keyword">@for</span> <span class="token variable">$i</span> <span class="token keyword">from</span> 1 <span class="token keyword">through</span> <span class="token selector"><span class="token variable">$max</span> </span><span class="token punctuation">{</span>
    <span class="token property"><span class="token variable">$rpxValue</span></span><span class="token punctuation">:</span> <span class="token function">nth</span><span class="token punctuation">(</span><span class="token variable">$rpxValues</span><span class="token punctuation">,</span> <span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property"><span class="token variable">$vminValues</span></span><span class="token punctuation">:</span> #<span class="token punctuation">{</span><span class="token variable">$vminValues</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token variable">$value</span> <span class="token operator">/</span> 7.5<span class="token punctuation">)</span><span class="token punctuation">}</span>vmin<span class="token punctuation">;</span>

    <span class="token keyword">@if</span> <span class="token selector"><span class="token variable">$i</span> &lt; <span class="token variable">$max</span> </span><span class="token punctuation">{</span>
      <span class="token property"><span class="token variable">$vminValues</span></span><span class="token punctuation">:</span> #<span class="token punctuation">{</span><span class="token variable">$vminValues</span> <span class="token operator">+</span> <span class="token string">' '</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token property"><span class="token variable">#{$property}</span></span><span class="token punctuation">:</span> <span class="token variable">$vminValues</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.box </span><span class="token punctuation">{</span>
  <span class="token keyword">@include</span> <span class="token function">rpx2vmin</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> 45<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">@include</span> <span class="token function">rpx2vmin</span><span class="token punctuation">(</span>margin<span class="token punctuation">,</span> 1<span class="token punctuation">,</span> 2<span class="token punctuation">,</span> 1<span class="token punctuation">,</span> .5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="使用-vscode-代码片段"><a href="#使用-vscode-代码片段" class="header-anchor">#</a> 使用 VSCode 代码片段</h2> <p>如果项目没有使用预处理器，可以在 VSCode 中创建代码片段，通过代码片段快速开发。</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;rpx to vmin&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vm&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;body&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;calc($0vmin / 7.5)&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Convert rpx to vmin&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#开启横屏" title="开启横屏">开启横屏</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#适配问题" title="适配问题">适配问题</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#使用-vmin-进行布局" title="使用 vmin 进行布局">使用 vmin 进行布局</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#使用-css-预处理器" title="使用 CSS 预处理器">使用 CSS 预处理器</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#使用-vscode-代码片段" title="使用 VSCode 代码片段">使用 VSCode 代码片段</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/evanmiao" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li><li class="contact-item" data-v-3d9deeb8><a href="mailto:evan.c.miao@gmail.com" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-3d9deeb8><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-3d9deeb8></path><polyline points="22,6 12,13 2,6" data-v-3d9deeb8></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8><a href="https://vuepress.vuejs.org/" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8>Powered by VuePress</a></li><li class="copyright-item" data-v-3d9deeb8><a href="/" class="nav-link" data-v-3d9deeb8>Copyright © 2019 Evan Miao</a></li></ul></div></footer></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.f964d282.js" defer></script><script src="/assets/js/6.921146d0.js" defer></script><script src="/assets/js/3.6e0db218.js" defer></script><script src="/assets/js/27.77ae7cd4.js" defer></script>
  </body>
</html>
